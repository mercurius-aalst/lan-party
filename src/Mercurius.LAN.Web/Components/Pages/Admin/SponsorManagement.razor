@page "/admin/sponsors"
@attribute [Authorize]
@using Mercurius.LAN.Web.DTOs.Sponsors
@using Mercurius.LAN.Web.Models.Participants
@using Mercurius.LAN.Web.Components.Shared
@using Microsoft.AspNetCore.Authorization
@rendermode InteractiveServer

<PageTitle>Sponsors Admin</PageTitle>

<div class="admin-container">
    <div class="admin-header">
        <h2>Manage Sponsors</h2>
    </div>

    <div class="search-bar-container">
        <CustomAutocomplete @ref="_autoCompleteComponent" TItem="SponsorManagementDTO" Items="_sponsors" ItemLabel="sponsor => sponsor.Name" OnSelected="OnSponsorSelected" Placeholder="Search Sponsors" />
    </div>

    @if(_selectedSponsor== null)
    {
        _selectedSponsor= new SponsorManagementDTO();
    }

    <EditForm Model="_selectedSponsor" OnValidSubmit="HandleSubmit">
        <DataAnnotationsValidator />
        <ValidationSummary />

        <div class="form-container">
            <h2>@(_isCreateMode ? "Create Sponsor" : "Update Sponsor")</h2>
            <div class="horizontal-layout">
                <div class="form-section">
                    <h3>Sponsor information</h3>
                    <div class="form-group">
                        <label for="name">Name</label>
                        <InputText id="username" class="form-control" @bind-Value="_selectedSponsor.Name" />
                    </div>

                    <div class="form-group">
                        <label for="infoUrl">Info url</label>
                        <InputText id="infoUrl" class="form-control" @bind-Value="_selectedSponsor.InfoUrl" />
                    </div>

                    <div class="form-group">
                        <label for="sponsorTier">Sponsor tier (1 = most important)</label>
                        <InputNumber id="sponsorTier" class="form-control" @bind-Value="_selectedSponsor.SponsorTier" />
                    </div>
                    <div class="form-group">
                        <label for="sponsorLogo">Logo</label>
                        <InputFile id="sponsorLogo" class="form-control" OnChange="UploadFile" accept="image/*" />
                    </div>
                </div>              
            </div>
            <div class="form-actions">
                <div class="form-actions-section">
                    <button type="submit" class="btn btn-primary">@(_isCreateMode ? "Create Sponsor" : "Update Sponsor")</button>
                </div>
                <div class="form-actions-section">
                    @if(!_isCreateMode)
                    {
                        <button type="button" class="btn btn-danger" @onclick="DeleteSponsor">Delete Sponsor</button>
                    }
                    <button type="button" class="btn btn-secondary" @onclick="ClearForm">Clear</button>
                </div>
            </div>
        </div>
    </EditForm>
</div>